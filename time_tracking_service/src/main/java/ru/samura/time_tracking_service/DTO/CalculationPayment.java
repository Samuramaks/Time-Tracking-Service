package ru.samura.time_tracking_service.DTO;

import lombok.AllArgsConstructor;
import lombok.Value;

/**
 * DTO для представления расчёта заработной платы сотрудника за отчётный период.
 * <p>
 * Содержит агрегированные данные: отработанные часы, норматив, переработка и итоговая сумма к выплате.
 * Не содержит бизнес-логики — только результат расчёта, выполненного в сервисном слое.
 * 
 * <p>
 * ⚠️ Все числовые значения выражены в <strong>целых часах</strong> (тип {@code long}), 
 * что предполагает округление (например, отбрасывание минут или округление по правилам компании).
 * При необходимости точных расчётов (например, с минутами) следует использовать {@code BigDecimal}
 * и хранить часы в дробном виде.
 * 
 *
 * @see EmployeeDTO
 */
@Value
@AllArgsConstructor
public class CalculationPayment {

    /**
     * Информация о сотруднике: ФИО, email, роль и др.
     * <p>
     * Используется для идентификации и отображения в отчётах.
     * 
     */
    EmployeeDTO employeeDTO;

    /**
     * Фактически отработанное время за период (в часах).
     * <p>
     * Вычисляется как сумма продолжительностей всех завершённых смен ({@link TimeEntry#checkOut} != null),
     * округлённая до целых часов (например, по правилу "в меньшую сторону" или "по 30-минутному порогу").
     * 
     * <p>
     * Всегда ≥ 0.
     * 
     */
    long totalHours;

    /**
     * Ожидаемое (нормативное) рабочее время за период (в часах).
     * <p>
     * Рассчитывается как: {@code количество рабочих дней × Employee.workHoursPerDay}.
     * Например: 20 рабочих дней × 8 ч/день = 160 ч.
     * 
     * <p>
     * Всегда ≥ 0.
     * 
     */
    long expectedHours;  // ← исправлено: "excepted" → "expected" (очевидная опечатка)

    /**
     * Разница между фактическим и нормативным временем (в часах).
     * <p>
     * {@code overtime = totalHours - expectedHours}.
     * 
     * <ul>
     *   <li>Положительное значение — переработка (оплачивается с коэффициентом).</li>
     *   <li>Нулевое — отработано в точности по норме.</li>
     *   <li>Отрицательное — недоработка (может повлиять на оклад или требовать отгулов).</li>
     * </ul>
     */
    long overtime;

    /**
     * Итоговая сумма к выплате (в условных единицах, например, рублях).
     * <p>
     * Формула расчёта зависит от политики компании, например:
     * <pre>
     * pay = expectedHours × hourlyRate
     *       + max(0, overtime) × hourlyRate × overtimeCoefficient
     * </pre>
     * Недоработка может уменьшать оклад пропорционально (если используется повременная оплата).
     * 
     * <p>
     * Всегда ≥ 0 (минимальная выплата — 0, если не предусмотрено иное).
     * 
     */
    long pay;
}